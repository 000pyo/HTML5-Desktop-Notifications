(function(win){var PERMISSION_DEFAULT="default",PERMISSION_GRANTED="granted",PERMISSION_DENIED="denied",PERMISSION=[PERMISSION_GRANTED,PERMISSION_DEFAULT,PERMISSION_DENIED],isSupported=(function(){try{return!!(win.Notification||win.webkitNotifications||navigator.mozNotification||(win.external&&win.external.msIsSiteMode()!==undefined));}catch(e){}}()),ieVerification=Math.floor((Math.random()*10)+1),isFunction=function(value){return(value&&(value).constructor===Function);},isString=function(value){return(value&&(value).constructor===String);},isObject=function(value){return(value&&(value).constructor===Object);},noop=function(){};function getNotification(title,options){var notification;if(win.Notification){notification=new win.Notification(title,{icon:isString(options.icon)?options.icon:options.icon["x32"],body:options.body||"",tag:options.tag||""});}else if(win.webkitNotifications){notification=win.webkitNotifications.createNotification(options.icon,title,options.body);notification.show();}else if(navigator.mozNotification){notification=navigator.mozNotification.createNotification(title,options.body,options.icon);notification.show();}else if(win.external&&win.external.msIsSiteMode()){win.external.msSiteModeClearIconOverlay();win.external.msSiteModeSetIconOverlay((isString(options.icon)?options.icon:options.icon["x16"]),title);win.external.msSiteModeActivate();notification={"ieVerification":++ieVerification};}return notification;}function getWrapper(notification){return{close:function(){if(notification&&notification.close){notification.close();}else if(win.external&&win.external.msIsSiteMode()){if(notification.ieVerification===ieVerification){win.external.msSiteModeClearIconOverlay();}}}};}function requestPermission(callback){if(!isSupported){return;}var callbackFunction=isFunction(callback)?callback:noop;if(win.webkitNotifications&&win.webkitNotifications.checkPermission){win.webkitNotifications.requestPermission(callbackFunction);}else if(win.Notification&&win.Notification.requestPermission){win.Notification.requestPermission(callbackFunction);}}function permissionLevel(){var permission;if(!isSupported){return;}if(win.Notification&&win.Notification.permissionLevel){permission=win.Notification.permissionLevel();}else if(win.webkitNotifications&&win.webkitNotifications.checkPermission){permission=PERMISSION[win.webkitNotifications.checkPermission()];}else if(navigator.mozNotification){permission=PERMISSION_GRANTED;}else if(win.external&&win.external.msIsSiteMode()){permission=PERMISSION_GRANTED;}return permission;}function createNotification(title,options){var notification,notificationWrapper;if(isSupported&&title&&isString(title)&&(isString(options.icon)||isObject(options.icon))&&(permissionLevel()===PERMISSION_GRANTED)){notification=getNotification(title,options);notificationWrapper=getWrapper(notification);if(options.timeout&&notification.addEventListener){notification.addEventListener("show",function(){var notification=notificationWrapper;win.setTimeout(function(){notification.close();},options.timeout);})}}return notificationWrapper;}win.notify={PERMISSION_DEFAULT:PERMISSION_DEFAULT,PERMISSION_GRANTED:PERMISSION_GRANTED,PERMISSION_DENIED:PERMISSION_DENIED,createNotification:createNotification,isSupported:isSupported,permissionLevel:permissionLevel,requestPermission:requestPermission};}(window));
